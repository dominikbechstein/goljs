<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <title>GoL</title>

</head>
<body>

<canvas id="world" height="400" width="400"></canvas>
<div id="info"></div>

<script>

var world   = document.getElementById("world").getContext("2d");
var info    = document.getElementById("info");

var dots    = [];
var cnt     = 0;

var height  = 200;
var width   = 200;

var b       = 0;
var bh      = height - 1;
var bw      = width  - 1;


function dot(world, x, y, state) {
    var _size  = 2;
    var _state = state === undefined ? (Math.random() * 10 > 8 ? 1 : 0) : state;

    world.fillStyle = _state ? "#66ff66" : "#ff6666";
    world.fillRect(x * _size, y * _size, _size, _size);

    return _state;
}


for (var x = 0; x < width; ++x) {
    var row = [];

   for (var y = 0; y < height; ++y) {
        row.push(dot(world, x, y));
    }

    dots.push(row);
}


var interval = setInterval(function () {
    var next = [];

    for (var x = 0; x < width; ++x) {
        var row = [];

        for (var y = 0; y < height; ++y) {
            /**
             * lt mt rt
             * lm mm rm
             * lb mb rb
             */

//*
            var sum =
                // top
                ((x === 0  || y === 0)  ? b : dots[x - 1]  [y - 1])    +
                ((x === 0)              ? b : dots[x - 1]  [y])        +
                ((x === 0  || y === bh) ? b : dots[x - 1]  [y + 1])    +
                // left / right
                ((y === 0)              ? b : dots[x]      [y - 1])    +
                ((y === bh)             ? b : dots[x]      [y + 1])    +
                // bottom
                ((x === bw || y === 0)  ? b : dots[x + 1]  [y - 1])    +
                ((x === bw)             ? b : dots[x + 1]  [y])        +
                ((x === bw || y === bh) ? b : dots[x + 1]  [y + 1])
            ;
/*/

            var lt = dots[x == 0 ? bw : x - 1]  [y == 0 ? bh : y - 1];
            var mt = dots[x == 0 ? bw : x - 1]  [y];
            var rt = dots[x == 0 ? bw : x - 1]  [y == bh ? 0 : y + 1];

            var lm = dots[x]                    [y == 0 ? bh : y - 1];
            var rm = dots[x]                    [y == bh ? 0 : y + 1];

            var lb = dots[x == bw ? 0 : x + 1]  [y == 0 ? bh : y - 1];
            var mb = dots[x == bw ? 0 : x + 1]  [y];
            var rb = dots[x == bw ? 0 : x + 1]  [y == bh ? 0 : y + 1];

            var sum =
                lt + mt + rt +
                lm + rm +
                lb + mb + rb
            ;
//*/
            var state = dots[x][y];

            if (state < 1) {
                if (sum == 3) {
                    state = 1;
                }
            } else {
                state = (sum < 2 || sum > 3) ? 0 : 1;
            }

            if (dots[x][y] !== state) {
                dot(world, x, y, state);
            }

            row.push(state);
        }

        next.push(row);
    }

    dots = [];

    // copy array
    for (var i = 0; i < next.length; ++i) {
        dots[i] = next[i].slice();
    }

    info.innerHTML = ++cnt;
}, 0);

</script>
</body>

</html>